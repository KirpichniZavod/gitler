<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≠ Mafia Game - –ú–∏—Ä –∏–Ω—Ç—Ä–∏–≥ –∏ –æ–±–º–∞–Ω–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding-bottom: 40px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .connection-status {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .status-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
            animation: pulse 2s infinite;
        }

        .status-connecting { background: #ffa500; }
        .status-connected { background: #4CAF50; }
        .status-error { background: #f44336; }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .debug-info {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .debug-info::-webkit-scrollbar {
            width: 8px;
        }

        .debug-info::-webkit-scrollbar-track {
            background: #34495e;
            border-radius: 4px;
        }

        .debug-info::-webkit-scrollbar-thumb {
            background: #7f8c8d;
            border-radius: 4px;
        }

        .debug-info::-webkit-scrollbar-thumb:hover {
            background: #95a5a6;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .main-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .auth-form {
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .tab.active {
            border-bottom-color: #667eea;
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .user-info {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-avatar {
            font-size: 2em;
            margin-right: 15px;
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .room-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .room-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .room-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .room-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }

        .room-status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .status-waiting {
            background: #d4edda;
            color: #155724;
        }

        .status-playing {
            background: #f8d7da;
            color: #721c24;
        }

        .chat-container {
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #e9ecef;
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #6c757d;
            border-radius: 4px;
        }

        .chat-input-container {
            padding: 15px;
            border-top: 1px solid #ddd;
            background: white;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            background: white;
            border-left: 4px solid #667eea;
        }

        .message-system {
            background: #fff3cd;
            border-left-color: #ffc107;
            font-style: italic;
        }

        .message-sender {
            font-weight: bold;
            color: #667eea;
            margin-right: 8px;
        }

        .game-info {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .role-info {
            background: #f3e5f5;
            border: 2px solid #9c27b0;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .players-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .player-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .player-card.dead {
            opacity: 0.6;
            background: #f8f9fa;
        }

        .player-avatar {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .store-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .store-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .store-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .store-item.owned {
            background: #d4edda;
            border-color: #28a745;
        }

        .effect-preview {
            font-size: 2em;
            margin: 15px 0;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .price {
            font-size: 1.2em;
            font-weight: bold;
            color: #ffc107;
            margin: 10px 0;
        }

        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-panel {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .admin-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .admin-header h2 {
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .admin-tabs {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 25px;
            gap: 10px;
        }

        .admin-tab {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .admin-tab.active {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
        }

        .admin-content {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .admin-section {
            display: none;
        }

        .admin-section.active {
            display: block;
        }

        .admin-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .admin-input {
            padding: 10px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 1em;
        }

        .admin-input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .admin-input:focus {
            outline: none;
            border-color: rgba(255,255,255,0.6);
            background: rgba(255,255,255,0.3);
        }

        .admin-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
        }

        .admin-btn.danger {
            background: rgba(220,53,69,0.3);
            border-color: rgba(220,53,69,0.5);
        }

        .admin-btn.danger:hover {
            background: rgba(220,53,69,0.5);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .users-list {
            max-height: 300px;
            overflow-y: auto;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }

        .user-item:last-child {
            margin-bottom: 0;
        }

        .user-details {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-actions {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            padding: 5px 10px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .logs-container {
            max-height: 400px;
            overflow-y: auto;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 3px;
        }

        .log-info { background: rgba(52,152,219,0.2); }
        .log-warning { background: rgba(241,196,15,0.2); }
        .log-error { background: rgba(231,76,60,0.2); }
        .log-success { background: rgba(46,204,113,0.2); }

        .rooms-management {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }

        .admin-room-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
        }

        .room-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –Ω–∏–∫–Ω–µ–π–º–æ–≤ */
        .effect-rainbow {
            background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: rainbow 2s ease-in-out infinite;
        }

        @keyframes rainbow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .effect-glow {
            text-shadow: 0 0 10px #667eea, 0 0 20px #667eea, 0 0 30px #667eea;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px #667eea, 0 0 20px #667eea, 0 0 30px #667eea; }
            to { text-shadow: 0 0 20px #667eea, 0 0 30px #667eea, 0 0 40px #667eea; }
        }

        .effect-shake {
            animation: shake 0.5s ease-in-out infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        .effect-bounce {
            animation: bounce 1s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .effect-fire {
            color: #ff4500;
            text-shadow: 0 0 5px #ff4500, 0 0 10px #ff4500, 0 0 15px #ff4500;
            animation: fire 1s ease-in-out infinite alternate;
        }

        @keyframes fire {
            0% { text-shadow: 0 0 5px #ff4500, 0 0 10px #ff4500, 0 0 15px #ff4500; }
            100% { text-shadow: 0 0 10px #ff6500, 0 0 20px #ff6500, 0 0 30px #ff6500; }
        }

        .effect-gold {
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
            font-weight: bold;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                padding: 10px 15px;
                font-size: 0.9em;
            }
            
            .admin-tabs {
                justify-content: center;
            }
            
            .admin-tab {
                padding: 8px 15px;
                font-size: 0.9em;
            }
            
            .admin-form {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* –°–∫—Ä—ã—Ç–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        .hidden {
            display: none !important;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .notification.success { background: #28a745; }
        .notification.error { background: #dc3545; }
        .notification.warning { background: #ffc107; color: #333; }
        .notification.info { background: #17a2b8; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé≠ Mafia Game</h1>
            <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä –∏–Ω—Ç—Ä–∏–≥ –∏ –æ–±–º–∞–Ω–∞</p>
        </div>

        <div class="connection-status" id="connectionStatus">
            <div>
                <span class="status-indicator status-connecting" id="statusIndicator"></span>
                <span id="statusText">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...</span>
            </div>
            <p id="statusSubtext">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</p>
            
            <div class="debug-info" id="debugInfo">
                üîç <strong>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong><br>
                üì° <strong>URL:</strong> WebSocket<br>
                üîÑ <strong>–ü–æ–ø—ã—Ç–∫–∏:</strong> 1<br>
                ‚è±Ô∏è <strong>–í—Ä–µ–º—è:</strong> -<br>
                ‚ùå <strong>–û—à–∏–±–∫–∏:</strong> -
            </div>
            
            <button class="btn" id="reconnectBtn" onclick="reconnect()">üîÑ –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</button>
        </div>

        <div class="main-content" id="mainContent">
            <div class="tabs" id="mainTabs">
                <div class="tab active" onclick="switchTab('auth')">üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</div>
                <div class="tab" onclick="switchTab('lobby')">üè† –õ–æ–±–±–∏</div>
                <div class="tab" onclick="switchTab('room')">üéÆ –ö–æ–º–Ω–∞—Ç–∞</div>
                <div class="tab" onclick="switchTab('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
                <div class="tab" onclick="switchTab('store')">üõí –ú–∞–≥–∞–∑–∏–Ω</div>
            </div>

            <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
            <div class="tab-content active" id="auth">
                <div class="auth-form">
                    <div class="tabs">
                        <div class="tab active" onclick="switchAuthTab('login')">–í—Ö–æ–¥</div>
                        <div class="tab" onclick="switchAuthTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                    </div>

                    <div class="tab-content active" id="loginForm">
                        <div class="form-group">
                            <label>–ù–∏–∫–Ω–µ–π–º:</label>
                            <input type="text" id="loginNickname" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º" maxlength="20">
                        </div>
                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å:</label>
                            <input type="password" id="loginPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" maxlength="20">
                        </div>
                        <button class="btn" onclick="login()">üö™ –í–æ–π—Ç–∏</button>
                    </div>

                    <div class="tab-content" id="registerForm">
                        <div class="form-group">
                            <label>–ù–∏–∫–Ω–µ–π–º:</label>
                            <input type="text" id="registerNickname" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∏–∫–Ω–µ–π–º (3-20 —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="20">
                        </div>
                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å:</label>
                            <input type="password" id="registerPassword" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å (4+ —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="20">
                        </div>
                        <div class="form-group">
                            <label>–ê–≤–∞—Ç–∞—Ä:</label>
                            <select id="registerAvatar">
                                <option value="üë§">üë§ –ß–µ–ª–æ–≤–µ–∫</option>
                                <option value="üïµÔ∏è">üïµÔ∏è –î–µ—Ç–µ–∫—Ç–∏–≤</option>
                                <option value="ü§µ">ü§µ –î–∂–µ–Ω—Ç–ª—å–º–µ–Ω</option>
                                <option value="üë©">üë© –õ–µ–¥–∏</option>
                                <option value="üßô">üßô –ú–∞–≥</option>
                                <option value="ü§ñ">ü§ñ –†–æ–±–æ—Ç</option>
                                <option value="üëª">üëª –ü—Ä–∏–∑—Ä–∞–∫</option>
                                <option value="üé≠">üé≠ –ê–∫—Ç—ë—Ä</option>
                                <option value="ü¶∏">ü¶∏ –ì–µ—Ä–æ–π</option>
                                <option value="ü•∑">ü•∑ –ù–∏–Ω–¥–∑—è</option>
                            </select>
                        </div>
                        <button class="btn" onclick="register()">üìù –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    </div>
                </div>
            </div>

            <!-- –õ–æ–±–±–∏ -->
            <div class="tab-content" id="lobby">
                <div class="user-info" id="userInfo" style="display: none;">
                    <div style="display: flex; align-items: center;">
                        <span class="user-avatar" id="userAvatar">üë§</span>
                        <div>
                            <div style="font-size: 1.2em; font-weight: bold;" id="userNickname">–ò–≥—Ä–æ–∫</div>
                            <div style="opacity: 0.8;">üí∞ <span id="userCoins">0</span> –º–æ–Ω–µ—Ç</div>
                        </div>
                    </div>
                    <button class="btn" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
                </div>

                <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
                <div class="admin-panel hidden" id="adminPanel">
                    <div class="admin-header">
                        <h2>üëë –ü–∞–Ω–µ–ª—å –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ê–Ω—É–±–∏—Å–∞</h2>
                        <p>–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–ª–∞—Å—Ç—å –Ω–∞–¥ –∏–≥—Ä–æ–≤—ã–º –º–∏—Ä–æ–º</p>
                    </div>

                    <div class="admin-tabs">
                        <div class="admin-tab active" onclick="switchAdminTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                        <div class="admin-tab" onclick="switchAdminTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                        <div class="admin-tab" onclick="switchAdminTab('rooms')">üè† –ö–æ–º–Ω–∞—Ç—ã</div>
                        <div class="admin-tab" onclick="switchAdminTab('actions')">‚ö° –î–µ–π—Å—Ç–≤–∏—è</div>
                        <div class="admin-tab" onclick="switchAdminTab('logs')">üìã –õ–æ–≥–∏</div>
                    </div>

                    <div class="admin-content">
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                        <div class="admin-section active" id="adminStats">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-number" id="onlineUsersCount">0</div>
                                    <div class="stat-label">–û–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-number" id="activeRoomsCount">0</div>
                                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-number" id="activeGamesCount">0</div>
                                    <div class="stat-label">–ò–≥—Ä –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-number" id="serverUptimeCount">0</div>
                                    <div class="stat-label">–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (–º–∏–Ω)</div>
                                </div>
                            </div>
                            <button class="admin-btn" onclick="refreshStats()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
                        </div>

                        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
                        <div class="admin-section" id="adminUsers">
                            <div class="admin-form">
                                <input type="text" class="admin-input" id="targetUser" placeholder="–ù–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                                <input type="number" class="admin-input" id="coinsAmount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç">
                                <button class="admin-btn" onclick="giveCoins()">üí∞ –í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã</button>
                            </div>
                            
                            <div class="admin-form">
                                <input type="text" class="admin-input" id="effectTargetUser" placeholder="–ù–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                                <select class="admin-input" id="effectSelect">
                                    <option value="rainbow">üåà –†–∞–¥—É–≥–∞</option>
                                    <option value="glow">‚ú® –°–≤–µ—á–µ–Ω–∏–µ</option>
                                    <option value="shake">üîÑ –¢—Ä—è—Å–∫–∞</option>
                                    <option value="bounce">‚¨ÜÔ∏è –ü—Ä—ã–∂–∫–∏</option>
                                    <option value="fire">üî• –û–≥–æ–Ω—å</option>
                                    <option value="gold">üëë –ó–æ–ª–æ—Ç–æ</option>
                                </select>
                                <button class="admin-btn" onclick="giveEffect()">üé® –í—ã–¥–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç</button>
                                <button class="admin-btn danger" onclick="removeEffect()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç</button>
                            </div>

                            <div class="users-list" id="onlineUsersList">
                                <div style="text-align: center; opacity: 0.7;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</div>
                            </div>
                        </div>

                        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–∞–º–∏ -->
                        <div class="admin-section" id="adminRooms">
                            <div class="admin-form">
                                <input type="text" class="admin-input" id="roomIdInput" placeholder="ID –∫–æ–º–Ω–∞—Ç—ã">
                                <button class="admin-btn danger" onclick="forceEndGame()">üõë –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É</button>
                                <button class="admin-btn danger" onclick="deleteRoom()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                            </div>

                            <div class="rooms-management" id="adminRoomsList">
                                <div style="text-align: center; opacity: 0.7;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç...</div>
                            </div>
                        </div>

                        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                        <div class="admin-section" id="adminActions">
                            <div class="admin-form">
                                <input type="text" class="admin-input" id="systemMessage" placeholder="–°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ">
                                <button class="admin-btn" onclick="sendSystemMessage()">üì¢ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ–º</button>
                            </div>

                            <div class="admin-form">
                                <input type="text" class="admin-input" id="botName" placeholder="–ò–º—è –±–æ—Ç–∞">
                                <select class="admin-input" id="botAvatar">
                                    <option value="ü§ñ">ü§ñ –†–æ–±–æ—Ç</option>
                                    <option value="üëæ">üëæ –ü—Ä–∏—à–µ–ª–µ—Ü</option>
                                    <option value="üé≠">üé≠ –ê–∫—Ç—ë—Ä</option>
                                    <option value="üïµÔ∏è">üïµÔ∏è –î–µ—Ç–µ–∫—Ç–∏–≤</option>
                                </select>
                                <button class="admin-btn" onclick="addBotToCurrentRoom()">ü§ñ –î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞</button>
                            </div>

                            <div class="admin-form">
                                <button class="admin-btn" onclick="restartServer()">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</button>
                                <button class="admin-btn danger" onclick="emergencyShutdown()">üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ</button>
                            </div>
                        </div>

                        <!-- –õ–æ–≥–∏ -->
                        <div class="admin-section" id="adminLogs">
                            <div style="margin-bottom: 15px;">
                                <button class="admin-btn" onclick="clearLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
                                <button class="admin-btn" onclick="refreshLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                                <button class="admin-btn" onclick="exportLogs()">üíæ –≠–∫—Å–ø–æ—Ä—Ç</button>
                            </div>
                            <div class="logs-container" id="adminLogsContainer">
                                <div class="log-entry log-info">[INFO] –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞</div>
                                <div class="log-entry log-success">[SUCCESS] –ê–Ω—É–±–∏—Å –±–ª–∞–≥–æ—Å–ª–æ–≤–∏–ª —ç—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>üè† –ò–≥—Ä–æ–≤—ã–µ –∫–æ–º–Ω–∞—Ç—ã</h2>
                    <button class="btn" onclick="showCreateRoomModal()">‚ûï –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                </div>

                <div class="rooms-grid" id="roomsList">
                    <div style="text-align: center; opacity: 0.7; grid-column: 1 / -1;">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–Ω–∞—Ç...
                    </div>
                </div>
            </div>

            <!-- –ö–æ–º–Ω–∞—Ç–∞ -->
            <div class="tab-content" id="room">
                <div id="roomInfo" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 id="roomName">–ö–æ–º–Ω–∞—Ç–∞</h2>
                        <div>
                            <button class="btn" id="startGameBtn" onclick="startGame()" style="display: none;">üéÆ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                            <button class="btn" onclick="leaveRoom()">üö™ –ü–æ–∫–∏–Ω—É—Ç—å</button>
                        </div>
                    </div>

                    <div class="role-info" id="roleInfo" style="display: none;">
                        <h3>üé≠ –í–∞—à–∞ —Ä–æ–ª—å: <span id="playerRole">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span></h3>
                        <p id="roleDescription">–û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã...</p>
                        <div id="mafiaMembers" style="display: none;">
                            <strong>üë• –ß–ª–µ–Ω—ã –º–∞—Ñ–∏–∏:</strong> <span id="mafiaList"></span>
                        </div>
                    </div>

                    <div class="game-info" id="gameInfo" style="display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>üåô –§–∞–∑–∞:</strong> <span id="gamePhase">–û–∂–∏–¥–∞–Ω–∏–µ</span><br>
                                <strong>üìÖ –î–µ–Ω—å:</strong> <span id="gameDay">0</span>
                            </div>
                            <div style="text-align: right;">
                                <strong>‚è∞ –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏:</strong><br>
                                <span id="timeLeft" style="font-size: 1.5em; font-weight: bold;">--:--</span>
                            </div>
                        </div>
                        <div id="lastAction" style="margin-top: 15px; font-style: italic; text-align: center;">
                            –û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã...
                        </div>
                    </div>

                    <div class="players-list" id="playersList">
                        <!-- –ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>

                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ -->
                        </div>
                        <div class="chat-input-container">
                            <input type="text" class="chat-input" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="200">
                            <button class="btn" onclick="sendMessage()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>
                    </div>
                </div>

                <div id="noRoom" style="text-align: center; padding: 50px;">
                    <h3>üè† –í—ã –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ–º–Ω–∞—Ç–µ</h3>
                    <p>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ª–æ–±–±–∏, —á—Ç–æ–±—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∏–≥—Ä–µ</p>
                    <button class="btn" onclick="switchTab('lobby')">üè† –í –ª–æ–±–±–∏</button>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div class="tab-content" id="profile">
                <div class="user-info">
                    <div style="display: flex; align-items: center;">
                        <span class="user-avatar" id="profileAvatar">üë§</span>
                        <div>
                            <div style="font-size: 1.5em; font-weight: bold;" id="profileNickname">–ò–≥—Ä–æ–∫</div>
                            <div style="opacity: 0.8;">üí∞ <span id="profileCoins">0</span> –º–æ–Ω–µ—Ç</div>
                        </div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #667eea;" id="gamesPlayed">0</div>
                        <div>üéÆ –ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #28a745;" id="gamesWon">0</div>
                        <div>üèÜ –ü–æ–±–µ–¥</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #ffc107;" id="gamesSurvived">0</div>
                        <div>üí™ –í—ã–∂–∏–≤–∞–Ω–∏–π</div>
                    </div>
                </div>

                <h3>üé® –°–º–µ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; margin: 20px 0;">
                    <div class="avatar-option" onclick="changeAvatar('üë§')">üë§</div>
                    <div class="avatar-option" onclick="changeAvatar('üïµÔ∏è')">üïµÔ∏è</div>
                    <div class="avatar-option" onclick="changeAvatar('ü§µ')">ü§µ</div>
                    <div class="avatar-option" onclick="changeAvatar('üë©')">üë©</div>
                    <div class="avatar-option" onclick="changeAvatar('üßô')">üßô</div>
                    <div class="avatar-option" onclick="changeAvatar('ü§ñ')">ü§ñ</div>
                    <div class="avatar-option" onclick="changeAvatar('üëª')">üëª</div>
                    <div class="avatar-option" onclick="changeAvatar('üé≠')">üé≠</div>
                    <div class="avatar-option" onclick="changeAvatar('ü¶∏')">ü¶∏</div>
                    <div class="avatar-option" onclick="changeAvatar('ü•∑')">ü•∑</div>
                </div>

                <style>
                    .avatar-option {
                        font-size: 2em;
                        padding: 15px;
                        text-align: center;
                        background: #f8f9fa;
                        border: 2px solid #e9ecef;
                        border-radius: 10px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .avatar-option:hover {
                        border-color: #667eea;
                        transform: scale(1.1);
                    }
                </style>

                <h3>‚ú® –ú–æ–∏ —ç—Ñ—Ñ–µ–∫—Ç—ã</h3>
                <div id="userEffects" style="margin: 20px 0;">
                    <p style="opacity: 0.7;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–æ–≤. –ö—É–ø–∏—Ç–µ –∏—Ö –≤ –º–∞–≥–∞–∑–∏–Ω–µ!</p>
                </div>
            </div>

            <!-- –ú–∞–≥–∞–∑–∏–Ω -->
            <div class="tab-content" id="store">
                <h2>üõí –ú–∞–≥–∞–∑–∏–Ω —ç—Ñ—Ñ–µ–∫—Ç–æ–≤</h2>
                <p style="margin-bottom: 20px; opacity: 0.8;">–ö—É–ø–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Å–≤–æ–µ–≥–æ –Ω–∏–∫–Ω–µ–π–º–∞!</p>

                <div class="store-grid">
                    <div class="store-item" data-effect="rainbow">
                        <h3>üåà –†–∞–¥—É–≥–∞</h3>
                        <div class="effect-preview">
                            <span class="effect-rainbow">–ù–∏–∫–Ω–µ–π–º</span>
                        </div>
                        <p>–ü–µ—Ä–µ–ª–∏–≤–∞—é—â–∏–π—Å—è —Ä–∞–¥—É–∂–Ω—ã–π —Ç–µ–∫—Å—Ç</p>
                        <div class="price">üí∞ 50 –º–æ–Ω–µ—Ç</div>
                        <button class="btn" onclick="buyEffect('rainbow', 50)">–ö—É–ø–∏—Ç—å</button>
                    </div>

                    <div class="store-item" data-effect="glow">
                        <h3>‚ú® –°–≤–µ—á–µ–Ω–∏–µ</h3>
                        <div class="effect-preview">
                            <span class="effect-glow">–ù–∏–∫–Ω–µ–π–º</span>
                        </div>
                        <p>–ú—è–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –≤–æ–∫—Ä—É–≥ —Ç–µ–∫—Å—Ç–∞</p>
                        <div class="price">üí∞ 30 –º–æ–Ω–µ—Ç</div>
                        <button class="btn" onclick="buyEffect('glow', 30)">–ö—É–ø–∏—Ç—å</button>
                    </div>

                    <div class="store-item" data-effect="shake">
                        <h3>üîÑ –¢—Ä—è—Å–∫–∞</h3>
                        <div class="effect-preview">
                            <span class="effect-shake">–ù–∏–∫–Ω–µ–π–º</span>
                        </div>
                        <p>–õ—ë–≥–∫–æ–µ –¥—Ä–æ–∂–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞</p>
                        <div class="price">üí∞ 25 –º–æ–Ω–µ—Ç</div>
                        <button class="btn" onclick="buyEffect('shake', 25)">–ö—É–ø–∏—Ç—å</button>
                    </div>

                    <div class="store-item" data-effect="bounce">
                        <h3>‚¨ÜÔ∏è –ü—Ä—ã–∂–∫–∏</h3>
                        <div class="effect-preview">
                            <span class="effect-bounce">–ù–∏–∫–Ω–µ–π–º</span>
                        </div>
                        <p>–ü–æ–¥–ø—Ä—ã–≥–∏–≤–∞—é—â–∏–π —Ç–µ–∫—Å—Ç</p>
                        <div class="price">üí∞ 20 –º–æ–Ω–µ—Ç</div>
                        <button class="btn" onclick="buyEffect('bounce', 20)">–ö—É–ø–∏—Ç—å</button>
                    </div>

                    <div class="store-item" data-effect="fire">
                        <h3>üî• –û–≥–æ–Ω—å</h3>
                        <div class="effect-preview">
                            <span class="effect-fire">–ù–∏–∫–Ω–µ–π–º</span>
                        </div>
                        <p>–ü—ã–ª–∞—é—â–∏–π –æ–≥–Ω–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç</p>
                        <div class="price">üí∞ 75 –º–æ–Ω–µ—Ç</div>
                        <button class="btn" onclick="buyEffect('fire', 75)">–ö—É–ø–∏—Ç—å</button>
                    </div>

                    <div class="store-item" data-effect="gold">
                        <h3>üëë –ó–æ–ª–æ—Ç–æ</h3>
                        <div class="effect-preview">
                            <span class="effect-gold">–ù–∏–∫–Ω–µ–π–º</span>
                        </div>
                        <p>–†–æ—Å–∫–æ—à–Ω—ã–π –∑–æ–ª–æ—Ç–æ–π —Ç–µ–∫—Å—Ç</p>
                        <div class="price">üí∞ 100 –º–æ–Ω–µ—Ç</div>
                        <button class="btn" onclick="buyEffect('gold', 100)">–ö—É–ø–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let ws = null;
        let currentUser = null;
        let currentRoom = null;
        let reconnectAttempts = 0;
        let maxReconnectAttempts = 5;
        let reconnectDelay = 1000;
        let isConnected = false;
        let connectionStartTime = null;
        let debugLogs = [];

        // WebSocket URL - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –ê–Ω—É–±–∏—Å–∞
        const WS_URL = 'wss://gitler.onrender.com/ws';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üéÆ Mafia Game –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...');
            addDebugLog('üéÆ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Enter –¥–ª—è —Ñ–æ—Ä–º
            setupEnterHandlers();
            
            // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
            connect();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(refreshStats, 30000);
        });

        function setupEnterHandlers() {
            // –í—Ö–æ–¥
            document.getElementById('loginPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') login();
            });
            
            // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            document.getElementById('registerPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') register();
            });
            
            // –ß–∞—Ç
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });
        }

        function addDebugLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}`;
            debugLogs.push(logMessage);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–≥–æ–≤
            if (debugLogs.length > 100) {
                debugLogs.shift();
            }
            
            updateDebugInfo();
            console.log(logMessage);
        }

        function updateDebugInfo() {
            const debugInfo = document.getElementById('debugInfo');
            const connectionTime = connectionStartTime ? 
                Math.floor((Date.now() - connectionStartTime) / 1000) : 0;
            
            debugInfo.innerHTML = `
                üîç <strong>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong><br>
                üì° <strong>URL:</strong> ${WS_URL}<br>
                üîÑ <strong>–ü–æ–ø—ã—Ç–∫–∏:</strong> ${reconnectAttempts + 1}<br>
                ‚è±Ô∏è <strong>–í—Ä–µ–º—è:</strong> ${connectionTime}—Å<br>
                ‚ùå <strong>–û—à–∏–±–∫–∏:</strong> ${debugLogs.filter(log => log.includes('ERROR')).length}<br>
                üìã <strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏:</strong><br>
                ${debugLogs.slice(-5).join('<br>')}
            `;
        }

        function connect() {
            if (ws && ws.readyState === WebSocket.OPEN) {
                addDebugLog('‚ö†Ô∏è –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                return;
            }

            connectionStartTime = Date.now();
            addDebugLog(`üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ${WS_URL}...`);
            
            updateConnectionStatus('connecting', '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...', '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º –ê–Ω—É–±–∏—Å–∞...');

            try {
                ws = new WebSocket(WS_URL);
                
                ws.onopen = function(event) {
                    addDebugLog('‚úÖ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                    isConnected = true;
                    reconnectAttempts = 0;
                    updateConnectionStatus('connected', '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ä–≤–µ—Ä—É', '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º –ê–Ω—É–±–∏—Å–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
                    document.getElementById('mainContent').style.display = 'block';
                };

                ws.onmessage = function(event) {
                    try {
                        const data = JSON.parse(event.data);
                        addDebugLog(`üì® –ü–æ–ª—É—á–µ–Ω–æ: ${data.type}`);
                        handleMessage(data);
                    } catch (error) {
                        addDebugLog(`‚ùå ERROR: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: ${error.message}`);
                        console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
                    }
                };

                ws.onclose = function(event) {
                    addDebugLog(`üîå –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ: –∫–æ–¥ ${event.code}, –ø—Ä–∏—á–∏–Ω–∞: ${event.reason}`);
                    isConnected = false;
                    
                    if (event.code !== 1000) { // –ù–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
                        updateConnectionStatus('error', '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ', '–ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...');
                        attemptReconnect();
                    }
                };

                ws.onerror = function(error) {
                    addDebugLog(`‚ùå ERROR: WebSocket –æ—à–∏–±–∫–∞: ${error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
                    console.error('WebSocket –æ—à–∏–±–∫–∞:', error);
                    updateConnectionStatus('error', '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ');
                };

            } catch (error) {
                addDebugLog(`‚ùå ERROR: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å WebSocket: ${error.message}`);
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è WebSocket:', error);
                updateConnectionStatus('error', '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
                attemptReconnect();
            }
        }

        function attemptReconnect() {
            if (reconnectAttempts >= maxReconnectAttempts) {
                addDebugLog('‚ùå ERROR: –ü—Ä–µ–≤—ã—à–µ–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
                updateConnectionStatus('error', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è', '–ü—Ä–µ–≤—ã—à–µ–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫');
                return;
            }

            reconnectAttempts++;
            const delay = reconnectDelay * Math.pow(2, reconnectAttempts - 1); // –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
            
            addDebugLog(`üîÑ –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ${reconnectAttempts}/${maxReconnectAttempts} —á–µ—Ä–µ–∑ ${delay}–º—Å`);
            updateConnectionStatus('connecting', '–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...', `–ü–æ–ø—ã—Ç–∫–∞ ${reconnectAttempts}/${maxReconnectAttempts}`);

            setTimeout(() => {
                if (!isConnected) {
                    connect();
                }
            }, delay);
        }

        function reconnect() {
            addDebugLog('üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ');
            reconnectAttempts = 0;
            if (ws) {
                ws.close();
            }
            setTimeout(connect, 1000);
        }

        function updateConnectionStatus(status, text, subtext) {
            const indicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            const statusSubtext = document.getElementById('statusSubtext');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
            indicator.className = `status-indicator status-${status}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            statusText.textContent = text;
            statusSubtext.textContent = subtext;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            const reconnectBtn = document.getElementById('reconnectBtn');
            reconnectBtn.style.display = status === 'error' ? 'inline-block' : 'none';
        }

        function sendMessage(type, data = {}) {
            if (!ws || ws.readyState !== WebSocket.OPEN) {
                addDebugLog('‚ùå ERROR: WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω');
                showNotification('–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
                return false;
            }

            try {
                const message = { type, ...data };
                ws.send(JSON.stringify(message));
                addDebugLog(`üì§ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: ${type}`);
                return true;
            } catch (error) {
                addDebugLog(`‚ùå ERROR: –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: ${error.message}`);
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
                return false;
            }
        }

        function handleMessage(data) {
            switch (data.type) {
                case 'connected':
                    addDebugLog('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ê–Ω—É–±–∏—Å–∞!');
                    break;
                    
                case 'loginSuccess':
                    handleLoginSuccess(data);
                    break;
                    
                case 'registerSuccess':
                    showNotification(data.message, 'success');
                    switchAuthTab('login');
                    break;
                    
                case 'rooms':
                    updateRoomsList(data.rooms);
                    break;
                    
                case 'roomJoined':
                    handleRoomJoined(data.room);
                    break;
                    
                case 'roomUpdated':
                    updateRoomInfo(data.room);
                    break;
                    
                case 'chatMessage':
                    addChatMessage(data);
                    break;
                    
                case 'gameStarted':
                    handleGameStarted(data.room);
                    break;
                    
                case 'roleAssigned':
                    handleRoleAssigned(data);
                    break;
                    
                case 'gameUpdate':
                    updateGameInfo(data.game);
                    break;
                    
                case 'userUpdated':
                    updateUserInfo(data.user);
                    break;
                    
                case 'effectBought':
                    handleEffectBought(data);
                    break;
                    
                case 'avatarUpdated':
                    updateUserAvatar(data.avatar);
                    break;
                    
                case 'stats':
                    updateStats(data.stats);
                    break;
                    
                case 'adminActionSuccess':
                    showNotification(data.message, 'success');
                    refreshAdminData();
                    break;
                    
                case 'error':
                    addDebugLog(`‚ùå ERROR: ${data.message}`);
                    showNotification(data.message, 'error');
                    break;
                    
                case 'pong':
                    addDebugLog('üèì Pong –ø–æ–ª—É—á–µ–Ω');
                    break;
                    
                default:
                    addDebugLog(`‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è: ${data.type}`);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function login() {
            const nickname = document.getElementById('loginNickname').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            
            if (!nickname || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            sendMessage('login', { nickname, password });
        }

        function register() {
            const nickname = document.getElementById('registerNickname').value.trim();
            const password = document.getElementById('registerPassword').value.trim();
            const avatar = document.getElementById('registerAvatar').value;
            
            if (!nickname || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            if (nickname.length < 3 || nickname.length > 20) {
                showNotification('–ù–∏–∫–Ω–µ–π–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 3 –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤', 'warning');
                return;
            }
            
            if (password.length < 4) {
                showNotification('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞', 'warning');
                return;
            }
            
            sendMessage('register', { nickname, password, avatar });
        }

        function handleLoginSuccess(data) {
            currentUser = data.user;
            addDebugLog(`üë§ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∫–∞–∫: ${currentUser.nickname}`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            updateUserInfo(currentUser);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω
            if (currentUser.is_admin) {
                document.getElementById('adminPanel').classList.remove('hidden');
                addDebugLog('üëë –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ê–Ω—É–±–∏—Å–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞');
                refreshAdminData();
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ª–æ–±–±–∏
            switchTab('lobby');
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç
            sendMessage('getRooms');
            
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser.nickname}!`, 'success');
        }

        function logout() {
            currentUser = null;
            currentRoom = null;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
            document.getElementById('adminPanel').classList.add('hidden');
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            switchTab('auth');
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—ã
            document.getElementById('loginNickname').value = '';
            document.getElementById('loginPassword').value = '';
            
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'info');
        }

        function updateUserInfo(user) {
            currentUser = user;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ª–æ–±–±–∏
            document.getElementById('userInfo').style.display = 'flex';
            document.getElementById('userAvatar').textContent = user.avatar;
            document.getElementById('userNickname').textContent = user.nickname;
            document.getElementById('userCoins').textContent = user.coins;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ø—Ä–æ—Ñ–∏–ª–µ
            document.getElementById('profileAvatar').textContent = user.avatar;
            document.getElementById('profileNickname').textContent = user.nickname;
            document.getElementById('profileCoins').textContent = user.coins;
            document.getElementById('gamesPlayed').textContent = user.games_played || 0;
            document.getElementById('gamesWon').textContent = user.games_won || 0;
            document.getElementById('gamesSurvived').textContent = user.games_survived || 0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ
            updateUserEffects(user.nickname_effects || []);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω
            updateStoreItems(user.nickname_effects || [], user.coins);
        }

        function updateUserEffects(effects) {
            const container = document.getElementById('userEffects');
            if (effects.length === 0) {
                container.innerHTML = '<p style="opacity: 0.7;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–æ–≤. –ö—É–ø–∏—Ç–µ –∏—Ö –≤ –º–∞–≥–∞–∑–∏–Ω–µ!</p>';
                return;
            }
            
            const effectNames = {
                rainbow: 'üåà –†–∞–¥—É–≥–∞',
                glow: '‚ú® –°–≤–µ—á–µ–Ω–∏–µ',
                shake: 'üîÑ –¢—Ä—è—Å–∫–∞',
                bounce: '‚¨ÜÔ∏è –ü—Ä—ã–∂–∫–∏',
                fire: 'üî• –û–≥–æ–Ω—å',
                gold: 'üëë –ó–æ–ª–æ—Ç–æ'
            };
            
            container.innerHTML = effects.map(effect => 
                `<span style="display: inline-block; margin: 5px; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                    ${effectNames[effect] || effect}
                </span>`
            ).join('');
        }

        function updateStoreItems(ownedEffects, coins) {
            const storeItems = document.querySelectorAll('.store-item');
            storeItems.forEach(item => {
                const effect = item.dataset.effect;
                const button = item.querySelector('button');
                
                if (ownedEffects.includes(effect)) {
                    item.classList.add('owned');
                    button.textContent = '‚úÖ –ö—É–ø–ª–µ–Ω–æ';
                    button.disabled = true;
                } else {
                    item.classList.remove('owned');
                    const price = parseInt(item.querySelector('.price').textContent.match(/\d+/)[0]);
                    if (coins < price) {
                        button.textContent = 'üí∏ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç';
                        button.disabled = true;
                    } else {
                        button.textContent = '–ö—É–ø–∏—Ç—å';
                        button.disabled = false;
                    }
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∫–æ–º–Ω–∞—Ç
        function updateRoomsList(rooms) {
            const container = document.getElementById('roomsList');
            
            if (rooms.length === 0) {
                container.innerHTML = '<div style="text-align: center; opacity: 0.7; grid-column: 1 / -1;">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç</div>';
                return;
            }
            
            container.innerHTML = rooms.map(room => `
                <div class="room-card">
                    <div class="room-header">
                        <div class="room-name">${room.name}</div>
                        <div class="room-status ${room.status === 'waiting' ? 'status-waiting' : 'status-playing'}">
                            ${room.status === 'waiting' ? '–û–∂–∏–¥–∞–Ω–∏–µ' : '–ò–≥—Ä–∞—é—Ç'}
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div>üë• –ò–≥—Ä–æ–∫–æ–≤: ${room.players}/${room.maxPlayers}</div>
                        <div>üëë –°–æ–∑–¥–∞—Ç–µ–ª—å: ${room.creator}</div>
                        ${room.hasPassword ? '<div>üîí –ü—Ä–∏–≤–∞—Ç–Ω–∞—è</div>' : ''}
                    </div>
                    <button class="btn" onclick="joinRoom('${room.id}')" 
                            ${room.status !== 'waiting' || room.players >= room.maxPlayers ? 'disabled' : ''}>
                        ${room.hasPassword ? 'üîí –í–æ–π—Ç–∏' : 'üö™ –í–æ–π—Ç–∏'}
                    </button>
                </div>
            `).join('');
        }

        function joinRoom(roomId) {
            const room = Array.from(document.querySelectorAll('.room-card')).find(card => 
                card.querySelector('button').getAttribute('onclick').includes(roomId)
            );
            
            if (!room) return;
            
            const hasPassword = room.textContent.includes('üîí –ü—Ä–∏–≤–∞—Ç–Ω–∞—è');
            let password = null;
            
            if (hasPassword) {
                password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –∫–æ–º–Ω–∞—Ç—ã:');
                if (password === null) return; // –û—Ç–º–µ–Ω–µ–Ω–æ
            }
            
            sendMessage('joinRoom', { roomId, password });
        }

        function handleRoomJoined(room) {
            currentRoom = room;
            updateRoomInfo(room);
            switchTab('room');
            
            // –û—á–∏—â–∞–µ–º —á–∞—Ç
            document.getElementById('chatMessages').innerHTML = '';
            
            showNotification(`–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ "${room.name}"`, 'success');
        }

        function updateRoomInfo(room) {
            currentRoom = room;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–Ω–∞—Ç–µ
            document.getElementById('roomInfo').style.display = 'block';
            document.getElementById('noRoom').style.display = 'none';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ
            document.getElementById('roomName').textContent = room.name;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ä—Ç–∞ —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è
            const startBtn = document.getElementById('startGameBtn');
            if (room.creator === currentUser.nickname && room.status === 'waiting') {
                startBtn.style.display = 'inline-block';
            } else {
                startBtn.style.display = 'none';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
            updatePlayersList(room.players);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            if (room.game) {
                updateGameInfo(room.game);
            }
        }

        function updatePlayersList(players) {
            const container = document.getElementById('playersList');
            
            container.innerHTML = players.map(player => `
                <div class="player-card ${!player.isAlive ? 'dead' : ''}">
                    <div class="player-avatar">${player.avatar}</div>
                    <div style="font-weight: bold;">${player.nickname}</div>
                    ${player.isCreator ? '<div style="color: #ffc107;">üëë –°–æ–∑–¥–∞—Ç–µ–ª—å</div>' : ''}
                    ${player.isBot ? '<div style="color: #6c757d;">ü§ñ –ë–æ—Ç</div>' : ''}
                    ${!player.isAlive ? '<div style="color: #dc3545;">üíÄ –ú—ë—Ä—Ç–≤</div>' : ''}
                    ${player.role && currentRoom.status === 'finished' ? `<div>üé≠ ${getRoleName(player.role)}</div>` : ''}
                </div>
            `).join('');
        }

        function getRoleName(role) {
            const roleNames = {
                'citizen': '–ú–∏—Ä–Ω—ã–π –∂–∏—Ç–µ–ª—å',
                'mafia': '–ú–∞—Ñ–∏—è',
                'don': '–î–æ–Ω –º–∞—Ñ–∏–∏',
                'doctor': '–î–æ–∫—Ç–æ—Ä',
                'lover1': '–í–ª—é–±–ª—ë–Ω–Ω—ã–π',
                'lover2': '–í–ª—é–±–ª—ë–Ω–Ω–∞—è'
            };
            return roleNames[role] || role;
        }

        function leaveRoom() {
            sendMessage('leaveRoom');
            currentRoom = null;
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ª–æ–±–±–∏
            switchTab('lobby');
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç
            sendMessage('getRooms');
        }

        function startGame() {
            if (!currentRoom || currentRoom.creator !== currentUser.nickname) {
                showNotification('–¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É', 'error');
                return;
            }
            
            sendMessage('startGame');
        }

        // –§—É–Ω–∫—Ü–∏–∏ —á–∞—Ç–∞
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            sendMessage('chatMessage', { message });
            input.value = '';
        }

        function addChatMessage(data) {
            const container = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${data.sender === '–°–∏—Å—Ç–µ–º–∞' ? 'message-system' : ''}`;
            
            const time = new Date(data.timestamp).toLocaleTimeString();
            messageDiv.innerHTML = `
                <span class="message-sender">${data.sender}</span>
                <span style="opacity: 0.6; font-size: 0.8em;">[${time}]</span><br>
                ${data.message}
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã
        function handleGameStarted(room) {
            updateRoomInfo(room);
            showNotification('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –£–¥–∞—á–∏!', 'success');
        }

        function handleRoleAssigned(data) {
            const roleInfo = document.getElementById('roleInfo');
            const roleElement = document.getElementById('playerRole');
            const descElement = document.getElementById('roleDescription');
            const mafiaElement = document.getElementById('mafiaMembers');
            const mafiaList = document.getElementById('mafiaList');
            
            roleInfo.style.display = 'block';
            roleElement.textContent = getRoleName(data.role);
            
            // –û–ø–∏—Å–∞–Ω–∏—è —Ä–æ–ª–µ–π
            const roleDescriptions = {
                'citizen': '–í—ã –º–∏—Ä–Ω—ã–π –∂–∏—Ç–µ–ª—å. –í–∞—à–∞ —Ü–µ–ª—å - –Ω–∞–π—Ç–∏ –∏ –∏–∑–≥–Ω–∞—Ç—å –≤—Å—é –º–∞—Ñ–∏—é.',
                'mafia': '–í—ã —á–ª–µ–Ω –º–∞—Ñ–∏–∏. –í–∞—à–∞ —Ü–µ–ª—å - —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ—Ö –º–∏—Ä–Ω—ã—Ö –∂–∏—Ç–µ–ª–µ–π.',
                'don': '–í—ã –¥–æ–Ω –º–∞—Ñ–∏–∏. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ –º–∞—Ñ–∏–µ–π –∏ —É—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –º–∏—Ä–Ω—ã—Ö –∂–∏—Ç–µ–ª–µ–π.',
                'doctor': '–í—ã –¥–æ–∫—Ç–æ—Ä. –ö–∞–∂–¥—É—é –Ω–æ—á—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–ø–∞—Å—Ç–∏ –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞.',
                'lover1': '–í—ã –≤–ª—é–±–ª—ë–Ω–Ω—ã–π. –ï—Å–ª–∏ –≤–∞—à–∞ –ø–∞—Ä–∞ —É–º—Ä—ë—Ç, –≤—ã —Ç–æ–∂–µ —É–º—Ä—ë—Ç–µ.',
                'lover2': '–í—ã –≤–ª—é–±–ª—ë–Ω–Ω–∞—è. –ï—Å–ª–∏ –≤–∞—à–∞ –ø–∞—Ä–∞ —É–º—Ä—ë—Ç, –≤—ã —Ç–æ–∂–µ —É–º—Ä—ë—Ç–µ.'
            };
            
            descElement.textContent = roleDescriptions[data.role] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ä–æ–ª—å';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á–ª–µ–Ω–æ–≤ –º–∞—Ñ–∏–∏ –µ—Å–ª–∏ –∏–≥—Ä–æ–∫ –º–∞—Ñ–∏—è
            if (data.mafiaMembers && data.mafiaMembers.length > 0) {
                mafiaElement.style.display = 'block';
                mafiaList.textContent = data.mafiaMembers.join(', ');
            } else {
                mafiaElement.style.display = 'none';
            }
        }

        function updateGameInfo(game) {
            const gameInfo = document.getElementById('gameInfo');
            gameInfo.style.display = 'block';
            
            document.getElementById('gamePhase').textContent = game.phase === 'night' ? 'üåô –ù–æ—á—å' : '‚òÄÔ∏è –î–µ–Ω—å';
            document.getElementById('gameDay').textContent = game.day;
            document.getElementById('lastAction').textContent = game.lastAction || '–û–∂–∏–¥–∞–Ω–∏–µ...';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä
            if (game.timeLeft > 0) {
                const minutes = Math.floor(game.timeLeft / 60);
                const seconds = game.timeLeft % 60;
                document.getElementById('timeLeft').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            } else {
                document.getElementById('timeLeft').textContent = '--:--';
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
        function changeAvatar(avatar) {
            sendMessage('updateAvatar', { avatar });
        }

        function updateUserAvatar(avatar) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –≤–µ–∑–¥–µ
            document.getElementById('userAvatar').textContent = avatar;
            document.getElementById('profileAvatar').textContent = avatar;
            
            if (currentUser) {
                currentUser.avatar = avatar;
            }
            
            showNotification('–ê–≤–∞—Ç–∞—Ä –æ–±–Ω–æ–≤–ª—ë–Ω!', 'success');
        }

        // –§—É–Ω–∫—Ü–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞
        function buyEffect(effect, price) {
            if (!currentUser) return;
            
            if (currentUser.coins < price) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!', 'error');
                return;
            }
            
            if (currentUser.nickname_effects && currentUser.nickname_effects.includes(effect)) {
                showNotification('–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —ç—Ç–æ—Ç —ç—Ñ—Ñ–µ–∫—Ç!', 'warning');
                return;
            }
            
            sendMessage('buyEffect', { effect });
        }

        function handleEffectBought(data) {
            showNotification(data.message, 'success');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            if (currentUser) {
                currentUser.coins = data.coins;
                currentUser.nickname_effects = data.nickname_effects;
                updateUserInfo(currentUser);
            }
        }

        // –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function switchAdminTab(tab) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-section').forEach(s => s.classList.remove('active'));
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            event.target.classList.add('active');
            document.getElementById(`admin${tab.charAt(0).toUpperCase() + tab.slice(1)}`).classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–±–∞
            switch(tab) {
                case 'stats':
                    refreshStats();
                    break;
                case 'users':
                    refreshOnlineUsers();
                    break;
                case 'rooms':
                    refreshAdminRooms();
                    break;
                case 'logs':
                    refreshLogs();
                    break;
            }
        }

        function refreshStats() {
            sendMessage('getStats');
        }

        function updateStats(stats) {
            document.getElementById('onlineUsersCount').textContent = stats.onlineUsers || 0;
            document.getElementById('activeRoomsCount').textContent = stats.activeRooms || 0;
            document.getElementById('activeGamesCount').textContent = stats.activeGames || 0;
            document.getElementById('serverUptimeCount').textContent = Math.floor((stats.uptime || 0) / 60);
        }

        function giveCoins() {
            const targetUser = document.getElementById('targetUser').value.trim();
            const amount = parseInt(document.getElementById('coinsAmount').value);
            
            if (!targetUser || !amount) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            sendMessage('adminAction', {
                action: 'giveCoins',
                target: targetUser,
                amount: amount
            });
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            document.getElementById('targetUser').value = '';
            document.getElementById('coinsAmount').value = '';
        }

        function giveEffect() {
            const targetUser = document.getElementById('effectTargetUser').value.trim();
            const effect = document.getElementById('effectSelect').value;
            
            if (!targetUser || !effect) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            sendMessage('adminAction', {
                action: 'giveEffect',
                target: targetUser,
                effect: effect
            });
            
            document.getElementById('effectTargetUser').value = '';
        }

        function removeEffect() {
            const targetUser = document.getElementById('effectTargetUser').value.trim();
            const effect = document.getElementById('effectSelect').value;
            
            if (!targetUser || !effect) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            sendMessage('adminAction', {
                action: 'removeEffect',
                target: targetUser,
                effect: effect
            });
            
            document.getElementById('effectTargetUser').value = '';
        }

        function addBotToCurrentRoom() {
            if (!currentRoom) {
                showNotification('–í—ã –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ–º–Ω–∞—Ç–µ', 'error');
                return;
            }
            
            const botName = document.getElementById('botName').value.trim() || `–ë–æ—Ç${Date.now()}`;
            const botAvatar = document.getElementById('botAvatar').value;
            
            sendMessage('addBot', { botName, botAvatar });
            
            document.getElementById('botName').value = '';
        }

        function forceEndGame() {
            const roomId = document.getElementById('roomIdInput').value.trim();
            
            if (!roomId && !currentRoom) {
                showNotification('–£–∫–∞–∂–∏—Ç–µ ID –∫–æ–º–Ω–∞—Ç—ã –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ –≤ –∫–æ–º–Ω–∞—Ç—É', 'warning');
                return;
            }
            
            sendMessage('forceEndGame', { roomId: roomId || currentRoom.id });
            document.getElementById('roomIdInput').value = '';
        }

        function refreshOnlineUsers() {
            // –ó–∞–≥–ª—É—à–∫–∞ - –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            const container = document.getElementById('onlineUsersList');
            container.innerHTML = '<div style="text-align: center; opacity: 0.7;">–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>';
        }

        function refreshAdminRooms() {
            // –ó–∞–≥–ª—É—à–∫–∞ - –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            const container = document.getElementById('adminRoomsList');
            container.innerHTML = '<div style="text-align: center; opacity: 0.7;">–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>';
        }

        function refreshLogs() {
            const container = document.getElementById('adminLogsContainer');
            container.innerHTML = debugLogs.slice(-20).map(log => {
                let logClass = 'log-info';
                if (log.includes('ERROR')) logClass = 'log-error';
                else if (log.includes('SUCCESS')) logClass = 'log-success';
                else if (log.includes('WARNING')) logClass = 'log-warning';
                
                return `<div class="log-entry ${logClass}">${log}</div>`;
            }).join('');
            
            container.scrollTop = container.scrollHeight;
        }

        function clearLogs() {
            debugLogs.length = 0;
            refreshLogs();
            showNotification('–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã', 'success');
        }

        function exportLogs() {
            const logsText = debugLogs.join('\n');
            const blob = new Blob([logsText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `mafia-game-logs-${new Date().toISOString().slice(0, 19)}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function sendSystemMessage() {
            const message = document.getElementById('systemMessage').value.trim();
            if (!message) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', 'warning');
                return;
            }
            
            // –ó–∞–≥–ª—É—à–∫–∞ - –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            showNotification('–°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)', 'info');
            document.getElementById('systemMessage').value = '';
        }

        function refreshAdminData() {
            refreshStats();
            refreshOnlineUsers();
            refreshAdminRooms();
            refreshLogs();
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function switchTab(tab) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤
            document.querySelectorAll('#mainTabs .tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∞–±–æ–≤
            switch(tab) {
                case 'lobby':
                    if (currentUser) {
                        sendMessage('getRooms');
                    }
                    break;
                case 'room':
                    if (!currentRoom) {
                        document.getElementById('roomInfo').style.display = 'none';
                        document.getElementById('noRoom').style.display = 'block';
                    }
                    break;
            }
        }

        function switchAuthTab(tab) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            document.querySelectorAll('#auth .tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('#auth .tab-content').forEach(c => c.classList.remove('active'));
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            event.target.classList.add('active');
            document.getElementById(tab + 'Form').classList.add('active');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // –£–±–∏—Ä–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã (–∑–∞–≥–ª—É—à–∫–∏)
        function showCreateRoomModal() {
            const name = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã:');
            if (!name) return;
            
            const maxPlayers = parseInt(prompt('–ú–∞–∫—Å–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤ (4-10):', '8'));
            if (!maxPlayers || maxPlayers < 4 || maxPlayers > 10) {
                showNotification('–ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤', 'error');
                return;
            }
            
            const password = prompt('–ü–∞—Ä–æ–ª—å (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–æ–π –∫–æ–º–Ω–∞—Ç—ã):') || null;
            
            sendMessage('createRoom', {
                room: {
                    name: name,
                    maxPlayers: maxPlayers,
                    minPlayers: Math.max(4, Math.floor(maxPlayers / 2)),
                    password: password,
                    roles: {
                        doctor: true,
                        don: true,
                        lovers: false
                    }
                }
            });
        }

        // –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
        function restartServer() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä?')) {
                showNotification('–§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'warning');
            }
        }

        function emergencyShutdown() {
            if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                showNotification('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'warning');
            }
        }

        function deleteRoom() {
            const roomId = document.getElementById('roomIdInput').value.trim();
            if (!roomId) {
                showNotification('–£–∫–∞–∂–∏—Ç–µ ID –∫–æ–º–Ω–∞—Ç—ã', 'warning');
                return;
            }
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É?')) {
                showNotification('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–º–Ω–∞—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'warning');
            }
        }

        // Ping –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        setInterval(() => {
            if (isConnected) {
                sendMessage('ping');
            }
        }, 30000);

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', function() {
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.close(1000, 'Page unload');
            }
        });
    </script>
</body>
</html>
